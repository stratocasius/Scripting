# Write the XML to the file
$collectorSetXml = @"
<?xml version="1.0" encoding="UTF-16"?>
<DataCollectorSet>
	<Status>0</Status>
	<Duration>21600</Duration>
	<Description>
	</Description>
	<DescriptionUnresolved>
	</DescriptionUnresolved>
	<DisplayName>
	</DisplayName>
	<DisplayNameUnresolved>
	</DisplayNameUnresolved>
	<SchedulesEnabled>-1</SchedulesEnabled>
	<LatestOutputLocation>C:\PerfLogs\Admin\JLTest-Apps\LT4036_20230419-000009</LatestOutputLocation>
	<Name>JL-ProcessesProcRamIO</Name>
	<OutputLocation>C:\PerfLogs\Admin\JL-ProcessesProcRamIO\LT4122_20230502-000010</OutputLocation>
	<RootPath>%systemdrive%\PerfLogs\Admin\JL-ProcessesProcRamIO</RootPath>
	<Segment>0</Segment>
	<SegmentMaxDuration>0</SegmentMaxDuration>
	<SegmentMaxSize>0</SegmentMaxSize>
	<SerialNumber>10</SerialNumber>
	<Server>
	</Server>
	<Subdirectory>
	</Subdirectory>
	<SubdirectoryFormat>3</SubdirectoryFormat>
	<SubdirectoryFormatPattern>yyyyMMdd\-NNNNNN</SubdirectoryFormatPattern>
	<Task>
	</Task>
	<TaskRunAsSelf>0</TaskRunAsSelf>
	<TaskArguments>
	</TaskArguments>
	<TaskUserTextArguments>
	</TaskUserTextArguments>
	<UserAccount>SYSTEM</UserAccount>
	<Security>O:BAG:DUD:AI(A;;FA;;;SY)(A;;FA;;;BA)(A;;0x1200a9;;;LU)(A;;0x1301ff;;;S-1-5-80-2661322625-712705077-2999183737-3043590567-590698655)(A;ID;0x1f019f;;;BA)(A;ID;0x1f019f;;;SY)(A;ID;FR;;;AU)(A;ID;FR;;;LS)(A;ID;FR;;;NS)(A;ID;FA;;;BA)</Security>
	<StopOnCompletion>0</StopOnCompletion>
	<PerformanceCounterDataCollector>
		<DataCollectorType>0</DataCollectorType>
		<Name>DataCollector01</Name>
		<FileName>DataCollector01</FileName>
		<FileNameFormat>1</FileNameFormat>
		<FileNameFormatPattern>
		</FileNameFormatPattern>
		<LogAppend>0</LogAppend>
		<LogCircular>0</LogCircular>
		<LogOverwrite>0</LogOverwrite>
		<LatestOutputLocation>C:\PerfLogs\Admin\JLTest-Apps\LT4036_20230419-000009\DataCollector01.blg</LatestOutputLocation>
		<DataSourceName>
		</DataSourceName>
		<SampleInterval>30</SampleInterval>
		<SegmentMaxRecords>0</SegmentMaxRecords>
		<LogFileFormat>3</LogFileFormat>
        <Counter>\Process(chrome)\% Processor Time</Counter>
        <Counter>\Process(chrome)\IO Data Bytes/sec</Counter>
        <Counter>\Process(chrome)\Private Bytes</Counter>
        <Counter>\Process(IntappTime)\% Processor Time</Counter>
        <Counter>\Process(IntappTime)\IO Data Bytes/sec</Counter>
        <Counter>\Process(IntappTime)\Private Bytes</Counter>
        <Counter>\Process(IntappTimeDesktopExtension)\% Processor Time</Counter>
        <Counter>\Process(IntappTimeDesktopExtension)\IO Data Bytes/sec</Counter>
        <Counter>\Process(IntappTimeDesktopExtension)\Private Bytes</Counter>
        <Counter>\Process(ir_agent)\% Processor Time</Counter>
        <Counter>\Process(ir_agent)\IO Data Bytes/sec</Counter>
        <Counter>\Process(ir_agent)\Private Bytes</Counter>
        <Counter>\Process(msedge)\% Processor Time</Counter>
        <Counter>\Process(msedge)\IO Data Bytes/sec</Counter>
         <Counter>\Process(msedge)\Private Bytes</Counter>
        <Counter>\Process(MsMpEng)\% Processor Time</Counter>
        <Counter>\Process(MsMpEng)\IO Data Bytes/sec</Counter>
        <Counter>\Process(MsMpEng)\Private Bytes</Counter>
         <Counter>\Process(ndOffice)\% Processor Time</Counter>
        <Counter>\Process(ndOffice)\IO Data Bytes/sec</Counter>
        <Counter>\Process(ndOffice)\Private Bytes</Counter>
        <Counter>\Process(NetDocuments.ndMail.Application)\% Processor Time</Counter>
        <Counter>\Process(NetDocuments.ndMail.Application)\IO Data Bytes/sec</Counter>
        <Counter>\Process(NetDocuments.ndMail.Application)\Private Bytes</Counter>
        <Counter>\Process(OneDrive)\% Processor Time</Counter>
        <Counter>\Process(OneDrive)\IO Data Bytes/sec</Counter>
        <Counter>\Process(OneDrive)\Private Bytes</Counter>
        <Counter>\Process(OUTLOOK)\% Processor Time</Counter>
        <Counter>\Process(OUTLOOK)\IO Data Bytes/sec</Counter>
        <Counter>\Process(OUTLOOK)\Private Bytes</Counter>
        <Counter>\Process(PowerPDF)\% Processor Time</Counter>
        <Counter>\Process(PowerPDF)\IO Data Bytes/sec</Counter>
        <Counter>\Process(PowerPDF)\Private Bytes</Counter>
        <Counter>\Process(stAgentSvc)\% Processor Time</Counter>
        <Counter>\Process(stAgentSvc)\IO Data Bytes/sec</Counter>
        <Counter>\Process(stAgentSvc)\Private Bytes</Counter>
        <Counter>\Process(Teams)\% Processor Time</Counter>
        <Counter>\Process(Teams)\IO Data Bytes/sec</Counter>
        <Counter>\Process(Teams)\Private Bytes</Counter>
        <Counter>\Process(WINWORD)\% Processor Time</Counter>
        <Counter>\Process(WINWORD)\IO Data Bytes/sec</Counter>
        <Counter>\Process(WINWORD)\Private Bytes</Counter>
<CounterDisplayName>\Process(chrome)\% Processor Time</CounterDisplayName>
<CounterDisplayName>\Process(chrome)\IO Data Bytes/sec</CounterDisplayName>
<CounterDisplayName>\Process(chrome)\Private Bytes</CounterDisplayName>
<CounterDisplayName>\Process(IntappTime)\% Processor Time</CounterDisplayName>
<CounterDisplayName>\Process(IntappTime)\IO Data Bytes/sec</CounterDisplayName>
<CounterDisplayName>\Process(IntappTime)\Private Bytes</CounterDisplayName>
<CounterDisplayName>\Process(IntappTimeDesktopExtension)\% Processor Time</CounterDisplayName>
<CounterDisplayName>\Process(IntappTimeDesktopExtension)\IO Data Bytes/sec</CounterDisplayName>
<CounterDisplayName>\Process(IntappTimeDesktopExtension)\Private Bytes</CounterDisplayName>
<CounterDisplayName>\Process(ir_agent)\% Processor Time</CounterDisplayName>
<CounterDisplayName>\Process(ir_agent)\IO Data Bytes/sec</CounterDisplayName>
<CounterDisplayName>\Process(ir_agent)\Private Bytes</CounterDisplayName>
<CounterDisplayName>\Process(msedge)\% Processor Time</CounterDisplayName>
<CounterDisplayName>\Process(msedge)\IO Data Bytes/sec</CounterDisplayName>
<CounterDisplayName>\Process(msedge)\Private Bytes</CounterDisplayName>
<CounterDisplayName>\Process(MsMpEng)\% Processor Time</CounterDisplayName>
<CounterDisplayName>\Process(MsMpEng)\IO Data Bytes/sec</CounterDisplayName>
<CounterDisplayName>\Process(MsMpEng)\Private Bytes</CounterDisplayName>
<CounterDisplayName>\Process(ndOffice)\% Processor Time</CounterDisplayName>
<CounterDisplayName>\Process(ndOffice)\IO Data Bytes/sec</CounterDisplayName>
<CounterDisplayName>\Process(ndOffice)\Private Bytes</CounterDisplayName>
<CounterDisplayName>\Process(NetDocuments.ndMail.Application)\% Processor Time</CounterDisplayName>
<CounterDisplayName>\Process(NetDocuments.ndMail.Application)\IO Data Bytes/sec</CounterDisplayName>
<CounterDisplayName>\Process(NetDocuments.ndMail.Application)\Private Bytes</CounterDisplayName>
<CounterDisplayName>\Process(OneDrive)\% Processor Time</CounterDisplayName>
<CounterDisplayName>\Process(OneDrive)\IO Data Bytes/sec</CounterDisplayName>
<CounterDisplayName>\Process(OneDrive)\Private Bytes</CounterDisplayName>
<CounterDisplayName>\Process(OUTLOOK)\% Processor Time</CounterDisplayName>
<CounterDisplayName>\Process(OUTLOOK)\IO Data Bytes/sec</CounterDisplayName>
<CounterDisplayName>\Process(OUTLOOK)\Private Bytes</CounterDisplayName>
<CounterDisplayName>\Process(PowerPDF)\% Processor Time</CounterDisplayName>
<CounterDisplayName>\Process(PowerPDF)\IO Data Bytes/sec</CounterDisplayName>
<CounterDisplayName>\Process(PowerPDF)\Private Bytes</CounterDisplayName>
<CounterDisplayName>\Process(stAgentSvc)\% Processor Time</CounterDisplayName>
<CounterDisplayName>\Process(stAgentSvc)\IO Data Bytes/sec</CounterDisplayName>
<CounterDisplayName>\Process(stAgentSvc)\Private Bytes</CounterDisplayName>
<CounterDisplayName>\Process(Teams)\% Processor Time</CounterDisplayName>
<CounterDisplayName>\Process(Teams)\IO Data Bytes/sec</CounterDisplayName>
<CounterDisplayName>\Process(Teams)\Private Bytes</CounterDisplayName>
<CounterDisplayName>\Process(WINWORD)\% Processor Time</CounterDisplayName>
<CounterDisplayName>\Process(WINWORD)\IO Data Bytes/sec</CounterDisplayName>
<CounterDisplayName>\Process(WINWORD)\Private Bytes</CounterDisplayName>
	</PerformanceCounterDataCollector>
	<DataManager>
		<Enabled>0</Enabled>
		<CheckBeforeRunning>0</CheckBeforeRunning>
		<MinFreeDisk>0</MinFreeDisk>
		<MaxSize>0</MaxSize>
		<MaxFolderCount>0</MaxFolderCount>
		<ResourcePolicy>0</ResourcePolicy>
		<ReportFileName>report.html</ReportFileName>
		<RuleTargetFileName>report.xml</RuleTargetFileName>
		<EventsFileName>
		</EventsFileName>
	</DataManager>
</DataCollectorSet>

"@

$collectorSetXml | Out-File -FilePath "C:\jltools\JLApps-ProcRamIO-6h.xml"
start-sleep 5
# Import the data collector set from the JL-Apps.xml file and save it as JLStats
$logmanCommand = "logman import -n JLStats3 -xml C:\jltools\JLApps-ProcRamIO-6h.xml"
Invoke-Expression $logmanCommand

# Start the data collection process using the JLStats data collector set
$logmanCommand = "logman start JLStats3"
Invoke-Expression $logmanCommand